<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">
    <t t-name="category_configurator.dialog">
        <Dialog size="size" title="title">
            <table class="o_sale_product_configurator_table table table-sm position-relative mb-0">
                <thead>
                    <t t-foreach="this.state.categories" t-as="category" t-key="category.id">
                        <tr>
                            <th colspan="2">
                                <div class="row g-2 mx-2">
                                    <div class="col-md-12 col-lg-4 p-2">
                                        <div class="d-flex flex-column flex-lg-row">
                                            <h4 class="mb-0">
                                                <span>Customer Asset Type:</span>
                                                <span class="ms-3">
                                                    <t t-esc="category.category_name"/>
                                                </span>
                                            </h4>
                                        </div>
                                    </div>
                                    <!-- <div class="col-md-12 col-lg-4 p-2">
                                        <div class="d-flex flex-column flex-lg-row">
                                            <h4 class="mb-0">
                                                <span>Product:</span>
                                                <span class="ms-3">
                                                    <t t-esc="category.product_name"/>
                                                </span>
                                            </h4>
                                        </div>
                                    </div> -->
                                </div>
                            </th>
                        </tr>
                    </t>
                </thead>
                <tbody class="border-top-0">
                    <t t-foreach="this.state.categories" t-as="category" t-key="category.name">
                        <tr>
                            <td colspan="2">
                                <div class="row g-1 mx-2">
                                    <t t-foreach="category.item_ids" t-as="line" t-key="line.id">
                                        <div class="col-md-6 p-1">
                                            <div class="d-flex align-items-center">
                                                <label t-out="line.label"
                                                       class="fw-bold text-break w-30 me-2"
                                                       t-att-style="'width:' + (line.field_type == 'checkbox' ? '17%' : '25%') + ';'" />
                                                <t t-if="line.field_type == 'option'">
                                                    <select class="o_input o_group_selector w-100 me-5"
                                                            t-on-change="updateItemValue"
                                                            t-att-id="line.id"
                                                            t-att-name="'item-' + line.id">
                                                        <option selected="1" value="none">
                                                            <!-- t-if="line.required == 'false'"  -->
                                                            <t t-esc="''" />
                                                        </option>
                                                        <option t-foreach="line.options"
                                                                t-as="option"
                                                                t-key="option.id"
                                                                t-att-value="option.id"
                                                                t-out="option.name"
                                                                t-att-selected="state.selectedItemIds.find(i => i.item_id === line.id)?.value == option.id" />
                                                    </select>
                                                </t>
                                                <t t-elif="line.field_type == 'integer'">
                                                    <input type="number"
                                                           class="o_input w-100 me-5"
                                                           t-att-id="line.id"
                                                           t-att-value="(state.selectedItemIds.find(i => i.item_id === line.id) and state.selectedItemIds.find(i => i.item_id === line.id).value) or ''"
                                                           t-on-change="updateItemValue"
                                                           placeholder="Enter a field value" />
                                                </t>
                                                <t t-elif="line.field_type == 'checkbox'">
                                                    <input type="checkbox"
                                                           class="form-check-input ms-2"
                                                           t-att-id="line.id"
                                                           t-att-checked="(state.selectedItemIds.find(i => i.item_id === line.id) and state.selectedItemIds.find(i => i.item_id === line.id).value) or false"
                                                           t-on-change="updateItemValue" />
                                                </t>
                                                <t t-elif="line.field_type == 'date'">
                                                    <input type="date"
                                                           class="form-check-input ms-2"
                                                           t-att-id="line.id"
                                                           t-att-checked="(state.selectedItemIds.find(i => i.item_id === line.id) and state.selectedItemIds.find(i => i.item_id === line.id).value) or false"
                                                           t-on-change="updateItemValue" 
                                                           style="width: 107px;height: 39px;"/>
                                                </t>
                                                <!-- <t t-elif="line.field_type == 'long'">
                                                    <textarea
                                                        t-on-change="updateItemValue"
                                                        t-att-id="line.id"
                                                        class="o_input d-print-none border-0 fst-italic"
                                                        placeholder="Enter a field value"
                                                        rows="1"
                                                        type="text"
                                                        t-att-class="o_input w-100 me-5"
                                                        t-att-value="(state.selectedItemIds.find(i => i.item_id === line.id) and state.selectedItemIds.find(i => i.item_id === line.id).value) or ''"
                                                    />
                                                </t> -->
                                                <t t-else="">
                                                <input type="text"
                                                       t-att-class="'o_input w-100 me-5 ' + (line.required !== 'false' ? 'required' : '')"
                                                       t-att-id="line.id"
                                                       t-att-maxlength="line.length"
                                                       t-att-value="(state.selectedItemIds.find(i => i.item_id === line.id) and state.selectedItemIds.find(i => i.item_id === line.id).value) || ''"
                                                       t-on-change="updateItemValue"
                                                       placeholder="Enter a field value"
                                                       />
                                                </t>
                                            </div>
                                        </div>
                                    </t>
                                </div>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
            <t t-set-slot="footer">
                <button name="product_category_configurator_confirm_button"
                        class="btn btn-primary"
                        t-on-click="() => this.env.addCategoryProduct(this.props.product_tmpl_id)">
                    Confirm
                </button>
                <button name="product_category_configurator_cancel_button"
                        class="btn btn-secondary"
                        t-on-click="onDiscard">
                    Cancel
                </button>
                <div class="alert alert-danger text-center"
                     role="alert"
                     t-if="state.warning_msg"
                     style="margin:auto;">
                    <!-- <span>Please fill the following required fields:</span> -->
                    <span style="margin-left:10px;">
                        <t t-esc="state.warning_msg"/>
                    </span>
                </div>
            </t>
        </Dialog>
    </t>
</templates>
